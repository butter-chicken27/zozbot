// Require the necessary discord.js classes
const { Client, Intents } = require('discord.js');
const dotenv = require('dotenv');
const axios = require('axios');
dotenv.config();

const story = new Map();
story.set(1, '1.PLAY AS SOPHIE, IN HOWL’S MOVING CASTLE Grandma\n2.Play as SOPHIE BUT IN SPIRITED AWAY, Radio');
story.set(11, 'A bright sunny morning, an old grandma narrates the myth of the legendary moving castle. It was believed that the castle was almost as high as a 5 storied building. The legend of chipping says that there is a wise wizard who resides in the castle and sees the prosperity of the whole Japan. The castle survived the worst nightmares that Japan had and had helped as a shelter to many and many people in the kind heartedness of the wizard. It is often said that people don’t remember who the wizard looks, even though many saw him in the times of crisis. Sophie then asks her grandma why the wizard is not remembered by anyone.\n1.Old Market Chipping\n2.New Market Chipping');
story.set(12, 'A bright sunny morning, a radio narrates the myth of the legendary bridge. It was believed that the bridge was made out of a unique metal nowhere to be found in the other parts of the world. The bridge survived the worst nightmares that Japan had and had helped guard many homes and towns. Since the Invasion of the shadows was not easy to cross this metal bridge, many shadows just formed their own ecosystem on the other side of the bridge. There were many occasions of people of the modern times being warned to inspect the place they see for living and the surroundings. In Spite of that many stay on the other side of the bridge, which is quite harmful, even though there is a miniature fort blocking the shadows.Sophie, a teenage girl, who was enjoying the outside view from her car suddenly becomes attentive to the radio since her family is living in that surroundings.\n1.Old Market Chipping\n2.New Market Chipping');
story.set(111, 'Sophie, a teenage girl, assists her parents in their Tailors work. Sophie is often cranky but when it comes to work she becomes attentive and determined towards it.  Sophie works in the basement of her house which is where her parents do the tailoring work. Sophie, after working on the beautiful cloth piece, takes a look at it in the mirror. As she sees herself in the mirror, she feels she is not beautiful and gets disheartened and continues finishing another cloth piece.  After a lousy day of work, she goes around market chipping, the marketplace of the town, along with her parents. Her parents take an alleged shortcut, to which Sophie insists on not taking the route. The route starts in a subway, which leads to an open, empty area. This road then the marketplace, a series of different shops, Sophie had never seen. These shops are vendorless and the aroma Sophie smells is different, which wasn’t the marketplace looked before. Each of these shops is filled with local delicacies. Sophie looks surprised as her parents go to these shops and check on them. Sophie, with an unpleasant feeling, runs away from the way they came back. To her surprise, she is stuck in a loop and each time she passes through the shop their parents were in, they slowly fade away into shadows and wander through the shop. Mysterious shadows start spawning from the adjacent shops.Shocked Sophie tries to enter the shop in which her parent’s shadow was locked in but could not enter. Sophie tries to run away again but then remembers she was stuck in the loop. In despair, Sophie gives up and cries.\n1.Witch of the waste, Obsessed with Howl\n2.Witch of the waste, obsession with power');
story.set(112, 'Sophie is often cranky but usually a very active girl, who observes what’s going on in her surroundings. Sophie is traveling to her new house, along with her parents and luggage. She goes around the place which was once called market chipping, the marketplace of an ancient town, along with her parents. Her parents said this is a shortcut and we can stop in the fort to eat, to which Sophie insists on not taking the route and stopping by. The route starts in a subway, which leads to an open, empty area, with an always light breeze. This road then leads them to the marketplace, a series of different shops. She recalls about this place being abandoned from the radio guy. These shops are vendorless and the aroma Sophie smells is different, which wasn’t the marketplace described as before. Each of these shops is filled with local delicacies. Sophie looks surprised as her parents go to these shops and check on them. Sophie, with an unpleasant feeling, runs away from the way they came back. To her surprise, she is stuck in a loop and each time she passes through the shop their parents were in, they slowly fade away into shadows and wander through the shop. Mysterious shadows start spawning from the adjacent shops. Shocked, Sophie tries to enter the shop in which her parent’s shadow is there but it was locked in and she could not enter. Sophie tries to run away again but then remembers she was stuck in the loop. In despair, Sophie gives up and cries.\n1.Witch of the waste, Obsessed with Howl\n2.Witch of the waste, obsession with power');
story.set(121, 'Sophie, a teenage girl, assists her parents in their Tailors work. Sophie is often cranky but when it comes to work she becomes attentive and determined towards it.  Sophie works in the basement of her house which is where her parents do the tailoring work. Sophie, after working on the beautiful cloth piece, takes a look at it in the mirror. As she sees herself in the mirror, she feels she is not beautiful and gets disheartened and continues finishing another cloth piece.  After a lousy day of work, she goes around market chipping, the marketplace of the town, along with her parents. Her parents take an alleged shortcut, to which Sophie insists on not taking the route. The route starts in a subway, which leads to an open, empty area. This road then the marketplace, a series of different shops, Sophie had never seen. These shops are vendorless and the aroma Sophie smells is different, which wasn’t the marketplace looked before. Each of these shops is filled with local delicacies. Sophie looks surprised as her parents go to these shops and check on them. Sophie, with an unpleasant feeling, runs away from the way they came back. To her surprise, she is stuck in a loop and each time she passes through the shop their parents were in, they slowly fade away into shadows and wander through the shop. Mysterious shadows start spawning from the adjacent shops.Shocked Sophie tries to enter the shop in which her parent’s shadow was locked in but could not enter. Sophie tries to run away again but then remembers she was stuck in the loop. In despair, Sophie gives up and cries.\n1.Witch of the waste, Obsessed with Howl\n2.Witch of the waste, obsession with power');
story.set(122, 'Sophie is often cranky but usually a very active girl, who observes what’s going on in her surroundings. Sophie is traveling to her new house, along with her parents and luggage. She goes around the place which was once called market chipping, the marketplace of an ancient town, along with her parents. Her parents said this is a shortcut and we can stop in the fort to eat, to which Sophie insists on not taking the route and stopping by. The route starts in a subway, which leads to an open, empty area, with an always light breeze. This road then leads them to the marketplace, a series of different shops. She recalls about this place being abandoned from the radio guy. These shops are vendorless and the aroma Sophie smells is different, which wasn’t the marketplace described as before. Each of these shops is filled with local delicacies. Sophie looks surprised as her parents go to these shops and check on them. Sophie, with an unpleasant feeling, runs away from the way they came back. To her surprise, she is stuck in a loop and each time she passes through the shop their parents were in, they slowly fade away into shadows and wander through the shop. Mysterious shadows start spawning from the adjacent shops. Shocked, Sophie tries to enter the shop in which her parent’s shadow is there but it was locked in and she could not enter. Sophie tries to run away again but then remembers she was stuck in the loop. In despair, Sophie gives up and cries.\n1.Witch of the waste, Obsessed with Howl\n2.Witch of the waste, obsession with power');
story.set(1111, 'Get the next part of the story [here](https://docs.google.com/document/d/1qha1LYmulW-v8EZ2GJblgALpgBBnrMOoCxTuYp1TCw4/edit\n1.Queen has no role\n2.Queen has an important climax.)');
story.set(1112, 'Get the next part of the story [here](https://docs.google.com/document/d/1Scu0hS8reMKJPHw0jB9rTZYF1EQdgBaDvawn_xZpFoA/edit)');
story.set(1121, 'Get the next part of the story [here](https://docs.google.com/document/d/1qha1LYmulW-v8EZ2GJblgALpgBBnrMOoCxTuYp1TCw4/edit)');
story.set(1122, 'Get the next part of the story [here](https://docs.google.com/document/d/1Scu0hS8reMKJPHw0jB9rTZYF1EQdgBaDvawn_xZpFoA/edit)');
story.set(1211, 'Get the next part of the story [here](https://docs.google.com/document/d/1qha1LYmulW-v8EZ2GJblgALpgBBnrMOoCxTuYp1TCw4/edit)');
story.set(1212, 'Get the next part of the story [here](https://docs.google.com/document/d/1Scu0hS8reMKJPHw0jB9rTZYF1EQdgBaDvawn_xZpFoA/edit)');
story.set(1221, 'Get the next part of the story [here](https://docs.google.com/document/d/1qha1LYmulW-v8EZ2GJblgALpgBBnrMOoCxTuYp1TCw4/edit)');
story.set(1222, 'Get the next part of the story [here](https://docs.google.com/document/d/1Scu0hS8reMKJPHw0jB9rTZYF1EQdgBaDvawn_xZpFoA/edit)');
story.set(11111, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.He goes to the spell trader, Abdullah. Abdullah is a wizard whose soccery runs on his business. He trades magic for power. Howl’s wizard powers are extremely powerful and rare as quoted by the queen herself. Abdullah readily agrees for the trade.Everything goes back to normal. The war which was about to happen was also stopped because of the spell Abdullah gave Howl. Howl and Sophie move in together peacefully after this incident. Sophie, who moved in as an 80 year old, becomes younger day by day spending time with Howl. Everyone is back to normal, except for the witch’s obsession over Howl. She still thinks Howl can belong to herself only. Witch arranges a meeting with the queen based on how Sophie can be a threat to Japan. They all meet in the courtroom, Howl, Witch and the queen. The queen notices the courtroom hall and remembers what actually happened. The queen was partly aware about the spell by then but did not disclose it out as it might harm Howl, her own disciple. Witch has the same thoughts as the queen, but instead will say it out loud. This causes Howl to transform in his original wizard form, the blue winged phoenix. His trade secret with Abdullah was simple: people will forget all of this happened, but if they remember in any case and conscience, you get transformed into your original form, but the ones who love you will be changed and transformed how they were before the time where Howl rescued Sophie from Shadows. Howl, creates all destruction before the castle, which was supposed to be a backup for Howl if something went wrong. It was Calcifer who kept the castle together and had been a trusted friend of Howl. All while Howl was creating ruckus, Calcifier had to become big enough to consume Howl, which would make Calcifer die. When Howl is in Calcifer, Sophie realizes there is a way all of this can be prevented. Howl shared the spell which was cast to him by Sophie,  so she knows the spell too. Sophie repeats the spell which Abdullah cast on Howl and casts it to the calcifer. This causes a loophole in the timeline, reverts everyone back to the birth of time. While all of this is happening, Howl says to Sophie her name and his name and asks her to remember his name.Pink lit sky, near the beach, Sophie in her 20s with Howl walks along the shore with a baby, whose name is Calcifer. Markl, Howl’s brother, helps an old woman cross the beach road and notices something is strange. The old woman begins to run towards Howl, but gets stopped by 2 skyline troops sent by the queen. With all this happening, none of Howl and Sophie were aware of anything.Years pass by and Sophie grows old. Howl, sits on his bench, reading his newspaper. Just then, he observes Sophie, who was narrating this story to her grandkids.');
story.set(11112, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.The queen helps Howl in the resurrection of the lives and removal of spells casted by the witch. The queen however has the motive to kill the witch of the waste, since she was being influenced by the witch.Howl and Sophie both on the other hand had another motive: Parents/ family of all the people who weren’t living in their human bodies. Howl for a reason had to do for some of the people since that was the direct order he had to follow. By listening to Howl’s perspective, the queen knew she had failed in fulfilling her duty as an empress. She did not put her people and their welfare in the first priority. So with an immediate action of removing the witch of the waste from her land, taking away her powers and causes of her powers, the queen did her least to make things correct for them.Sophie reunites with her parents in the back of the courtyard, where everyone is back to themselves. Sophie continues to visit the castle, Markl and Howl everyday since their parents had to take a left turn near the fort to get to their home instead of going into the fort.');
story.set(11121, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.He goes to the spell trader, Abdullah. Abdullah is a wizard whose soccery runs on his business. He trades magic for power. Howl’s wizard powers are extremely powerful and rare as quoted by the queen herself. Abdullah readily agrees for the trade.Everything goes back to normal. The war which was about to happen was also stopped because of the spell Abdullah gave Howl. Howl and Sophie move in together peacefully after this incident. Sophie, who moved in as an 80 year old, becomes younger day by day spending time with Howl. Everyone is back to normal, except for the witch’s obsession over Howl. She still thinks Howl can belong to herself only. Witch arranges a meeting with the queen based on how Sophie can be a threat to Japan. They all meet in the courtroom, Howl, Witch and the queen. The queen notices the courtroom hall and remembers what actually happened. The queen was partly aware about the spell by then but did not disclose it out as it might harm Howl, her own disciple. Witch has the same thoughts as the queen, but instead will say it out loud. This causes Howl to transform in his original wizard form, the blue winged phoenix. His trade secret with Abdullah was simple: people will forget all of this happened, but if they remember in any case and conscience, you get transformed into your original form, but the ones who love you will be changed and transformed how they were before the time where Howl rescued Sophie from Shadows. Howl, creates all destruction before the castle, which was supposed to be a backup for Howl if something went wrong. It was Calcifer who kept the castle together and had been a trusted friend of Howl. All while Howl was creating ruckus, Calcifier had to become big enough to consume Howl, which would make Calcifer die. When Howl is in Calcifer, Sophie realizes there is a way all of this can be prevented. Howl shared the spell which was cast to him by Sophie,  so she knows the spell too. Sophie repeats the spell which Abdullah cast on Howl and casts it to the calcifer. This causes a loophole in the timeline, reverts everyone back to the birth of time. While all of this is happening, Howl says to Sophie her name and his name and asks her to remember his name.Pink lit sky, near the beach, Sophie in her 20s with Howl walks along the shore with a baby, whose name is Calcifer. Markl, Howl’s brother, helps an old woman cross the beach road and notices something is strange. The old woman begins to run towards Howl, but gets stopped by 2 skyline troops sent by the queen. With all this happening, none of Howl and Sophie were aware of anything.Years pass by and Sophie grows old. Howl, sits on his bench, reading his newspaper. Just then, he observes Sophie, who was narrating this story to her grandkids.');
story.set(11122, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.The queen helps Howl in the resurrection of the lives and removal of spells casted by the witch. The queen however has the motive to kill the witch of the waste, since she was being influenced by the witch.Howl and Sophie both on the other hand had another motive: Parents/ family of all the people who weren’t living in their human bodies. Howl for a reason had to do for some of the people since that was the direct order he had to follow. By listening to Howl’s perspective, the queen knew she had failed in fulfilling her duty as an empress. She did not put her people and their welfare in the first priority. So with an immediate action of removing the witch of the waste from her land, taking away her powers and causes of her powers, the queen did her least to make things correct for them.Sophie reunites with her parents in the back of the courtyard, where everyone is back to themselves. Sophie continues to visit the castle, Markl and Howl everyday since their parents had to take a left turn near the fort to get to their home instead of going into the fort.');
story.set(11211, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.He goes to the spell trader, Abdullah. Abdullah is a wizard whose soccery runs on his business. He trades magic for power. Howl’s wizard powers are extremely powerful and rare as quoted by the queen herself. Abdullah readily agrees for the trade.Everything goes back to normal. The war which was about to happen was also stopped because of the spell Abdullah gave Howl. Howl and Sophie move in together peacefully after this incident. Sophie, who moved in as an 80 year old, becomes younger day by day spending time with Howl. Everyone is back to normal, except for the witch’s obsession over Howl. She still thinks Howl can belong to herself only. Witch arranges a meeting with the queen based on how Sophie can be a threat to Japan. They all meet in the courtroom, Howl, Witch and the queen. The queen notices the courtroom hall and remembers what actually happened. The queen was partly aware about the spell by then but did not disclose it out as it might harm Howl, her own disciple. Witch has the same thoughts as the queen, but instead will say it out loud. This causes Howl to transform in his original wizard form, the blue winged phoenix. His trade secret with Abdullah was simple: people will forget all of this happened, but if they remember in any case and conscience, you get transformed into your original form, but the ones who love you will be changed and transformed how they were before the time where Howl rescued Sophie from Shadows. Howl, creates all destruction before the castle, which was supposed to be a backup for Howl if something went wrong. It was Calcifer who kept the castle together and had been a trusted friend of Howl. All while Howl was creating ruckus, Calcifier had to become big enough to consume Howl, which would make Calcifer die. When Howl is in Calcifer, Sophie realizes there is a way all of this can be prevented. Howl shared the spell which was cast to him by Sophie,  so she knows the spell too. Sophie repeats the spell which Abdullah cast on Howl and casts it to the calcifer. This causes a loophole in the timeline, reverts everyone back to the birth of time. While all of this is happening, Howl says to Sophie her name and his name and asks her to remember his name.Pink lit sky, near the beach, Sophie in her 20s with Howl walks along the shore with a baby, whose name is Calcifer. Markl, Howl’s brother, helps an old woman cross the beach road and notices something is strange. The old woman begins to run towards Howl, but gets stopped by 2 skyline troops sent by the queen. With all this happening, none of Howl and Sophie were aware of anything.Years pass by and Sophie grows old. Howl, sits on his bench, reading his newspaper. Just then, he observes Sophie, who was narrating this story to her grandkids.');
story.set(11212, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.The queen helps Howl in the resurrection of the lives and removal of spells casted by the witch. The queen however has the motive to kill the witch of the waste, since she was being influenced by the witch.Howl and Sophie both on the other hand had another motive: Parents/ family of all the people who weren’t living in their human bodies. Howl for a reason had to do for some of the people since that was the direct order he had to follow. By listening to Howl’s perspective, the queen knew she had failed in fulfilling her duty as an empress. She did not put her people and their welfare in the first priority. So with an immediate action of removing the witch of the waste from her land, taking away her powers and causes of her powers, the queen did her least to make things correct for them.Sophie reunites with her parents in the back of the courtyard, where everyone is back to themselves. Sophie continues to visit the castle, Markl and Howl everyday since their parents had to take a left turn near the fort to get to their home instead of going into the fort.');
story.set(11221, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.He goes to the spell trader, Abdullah. Abdullah is a wizard whose soccery runs on his business. He trades magic for power. Howl’s wizard powers are extremely powerful and rare as quoted by the queen herself. Abdullah readily agrees for the trade.Everything goes back to normal. The war which was about to happen was also stopped because of the spell Abdullah gave Howl. Howl and Sophie move in together peacefully after this incident. Sophie, who moved in as an 80 year old, becomes younger day by day spending time with Howl. Everyone is back to normal, except for the witch’s obsession over Howl. She still thinks Howl can belong to herself only. Witch arranges a meeting with the queen based on how Sophie can be a threat to Japan. They all meet in the courtroom, Howl, Witch and the queen. The queen notices the courtroom hall and remembers what actually happened. The queen was partly aware about the spell by then but did not disclose it out as it might harm Howl, her own disciple. Witch has the same thoughts as the queen, but instead will say it out loud. This causes Howl to transform in his original wizard form, the blue winged phoenix. His trade secret with Abdullah was simple: people will forget all of this happened, but if they remember in any case and conscience, you get transformed into your original form, but the ones who love you will be changed and transformed how they were before the time where Howl rescued Sophie from Shadows. Howl, creates all destruction before the castle, which was supposed to be a backup for Howl if something went wrong. It was Calcifer who kept the castle together and had been a trusted friend of Howl. All while Howl was creating ruckus, Calcifier had to become big enough to consume Howl, which would make Calcifer die. When Howl is in Calcifer, Sophie realizes there is a way all of this can be prevented. Howl shared the spell which was cast to him by Sophie,  so she knows the spell too. Sophie repeats the spell which Abdullah cast on Howl and casts it to the calcifer. This causes a loophole in the timeline, reverts everyone back to the birth of time. While all of this is happening, Howl says to Sophie her name and his name and asks her to remember his name.Pink lit sky, near the beach, Sophie in her 20s with Howl walks along the shore with a baby, whose name is Calcifer. Markl, Howl’s brother, helps an old woman cross the beach road and notices something is strange. The old woman begins to run towards Howl, but gets stopped by 2 skyline troops sent by the queen. With all this happening, none of Howl and Sophie were aware of anything.Years pass by and Sophie grows old. Howl, sits on his bench, reading his newspaper. Just then, he observes Sophie, who was narrating this story to her grandkids.');
story.set(11222, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.The queen helps Howl in the resurrection of the lives and removal of spells casted by the witch. The queen however has the motive to kill the witch of the waste, since she was being influenced by the witch.Howl and Sophie both on the other hand had another motive: Parents/ family of all the people who weren’t living in their human bodies. Howl for a reason had to do for some of the people since that was the direct order he had to follow. By listening to Howl’s perspective, the queen knew she had failed in fulfilling her duty as an empress. She did not put her people and their welfare in the first priority. So with an immediate action of removing the witch of the waste from her land, taking away her powers and causes of her powers, the queen did her least to make things correct for them.Sophie reunites with her parents in the back of the courtyard, where everyone is back to themselves. Sophie continues to visit the castle, Markl and Howl everyday since their parents had to take a left turn near the fort to get to their home instead of going into the fort.');
story.set(12111, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.He goes to the spell trader, Abdullah. Abdullah is a wizard whose soccery runs on his business. He trades magic for power. Howl’s wizard powers are extremely powerful and rare as quoted by the queen herself. Abdullah readily agrees for the trade.Everything goes back to normal. The war which was about to happen was also stopped because of the spell Abdullah gave Howl. Howl and Sophie move in together peacefully after this incident. Sophie, who moved in as an 80 year old, becomes younger day by day spending time with Howl. Everyone is back to normal, except for the witch’s obsession over Howl. She still thinks Howl can belong to herself only. Witch arranges a meeting with the queen based on how Sophie can be a threat to Japan. They all meet in the courtroom, Howl, Witch and the queen. The queen notices the courtroom hall and remembers what actually happened. The queen was partly aware about the spell by then but did not disclose it out as it might harm Howl, her own disciple. Witch has the same thoughts as the queen, but instead will say it out loud. This causes Howl to transform in his original wizard form, the blue winged phoenix. His trade secret with Abdullah was simple: people will forget all of this happened, but if they remember in any case and conscience, you get transformed into your original form, but the ones who love you will be changed and transformed how they were before the time where Howl rescued Sophie from Shadows. Howl, creates all destruction before the castle, which was supposed to be a backup for Howl if something went wrong. It was Calcifer who kept the castle together and had been a trusted friend of Howl. All while Howl was creating ruckus, Calcifier had to become big enough to consume Howl, which would make Calcifer die. When Howl is in Calcifer, Sophie realizes there is a way all of this can be prevented. Howl shared the spell which was cast to him by Sophie,  so she knows the spell too. Sophie repeats the spell which Abdullah cast on Howl and casts it to the calcifer. This causes a loophole in the timeline, reverts everyone back to the birth of time. While all of this is happening, Howl says to Sophie her name and his name and asks her to remember his name.Pink lit sky, near the beach, Sophie in her 20s with Howl walks along the shore with a baby, whose name is Calcifer. Markl, Howl’s brother, helps an old woman cross the beach road and notices something is strange. The old woman begins to run towards Howl, but gets stopped by 2 skyline troops sent by the queen. With all this happening, none of Howl and Sophie were aware of anything.Years pass by and Sophie grows old. Howl, sits on his bench, reading his newspaper. Just then, he observes Sophie, who was narrating this story to her grandkids.');
story.set(12112, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.The queen helps Howl in the resurrection of the lives and removal of spells casted by the witch. The queen however has the motive to kill the witch of the waste, since she was being influenced by the witch.Howl and Sophie both on the other hand had another motive: Parents/ family of all the people who weren’t living in their human bodies. Howl for a reason had to do for some of the people since that was the direct order he had to follow. By listening to Howl’s perspective, the queen knew she had failed in fulfilling her duty as an empress. She did not put her people and their welfare in the first priority. So with an immediate action of removing the witch of the waste from her land, taking away her powers and causes of her powers, the queen did her least to make things correct for them.Sophie reunites with her parents in the back of the courtyard, where everyone is back to themselves. Sophie continues to visit the castle, Markl and Howl everyday since their parents had to take a left turn near the fort to get to their home instead of going into the fort.');
story.set(12121, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.He goes to the spell trader, Abdullah. Abdullah is a wizard whose soccery runs on his business. He trades magic for power. Howl’s wizard powers are extremely powerful and rare as quoted by the queen herself. Abdullah readily agrees for the trade.Everything goes back to normal. The war which was about to happen was also stopped because of the spell Abdullah gave Howl. Howl and Sophie move in together peacefully after this incident. Sophie, who moved in as an 80 year old, becomes younger day by day spending time with Howl. Everyone is back to normal, except for the witch’s obsession over Howl. She still thinks Howl can belong to herself only. Witch arranges a meeting with the queen based on how Sophie can be a threat to Japan. They all meet in the courtroom, Howl, Witch and the queen. The queen notices the courtroom hall and remembers what actually happened. The queen was partly aware about the spell by then but did not disclose it out as it might harm Howl, her own disciple. Witch has the same thoughts as the queen, but instead will say it out loud. This causes Howl to transform in his original wizard form, the blue winged phoenix. His trade secret with Abdullah was simple: people will forget all of this happened, but if they remember in any case and conscience, you get transformed into your original form, but the ones who love you will be changed and transformed how they were before the time where Howl rescued Sophie from Shadows. Howl, creates all destruction before the castle, which was supposed to be a backup for Howl if something went wrong. It was Calcifer who kept the castle together and had been a trusted friend of Howl. All while Howl was creating ruckus, Calcifier had to become big enough to consume Howl, which would make Calcifer die. When Howl is in Calcifer, Sophie realizes there is a way all of this can be prevented. Howl shared the spell which was cast to him by Sophie,  so she knows the spell too. Sophie repeats the spell which Abdullah cast on Howl and casts it to the calcifer. This causes a loophole in the timeline, reverts everyone back to the birth of time. While all of this is happening, Howl says to Sophie her name and his name and asks her to remember his name.Pink lit sky, near the beach, Sophie in her 20s with Howl walks along the shore with a baby, whose name is Calcifer. Markl, Howl’s brother, helps an old woman cross the beach road and notices something is strange. The old woman begins to run towards Howl, but gets stopped by 2 skyline troops sent by the queen. With all this happening, none of Howl and Sophie were aware of anything.Years pass by and Sophie grows old. Howl, sits on his bench, reading his newspaper. Just then, he observes Sophie, who was narrating this story to her grandkids.');
story.set(12122, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.The queen helps Howl in the resurrection of the lives and removal of spells casted by the witch. The queen however has the motive to kill the witch of the waste, since she was being influenced by the witch.Howl and Sophie both on the other hand had another motive: Parents/ family of all the people who weren’t living in their human bodies. Howl for a reason had to do for some of the people since that was the direct order he had to follow. By listening to Howl’s perspective, the queen knew she had failed in fulfilling her duty as an empress. She did not put her people and their welfare in the first priority. So with an immediate action of removing the witch of the waste from her land, taking away her powers and causes of her powers, the queen did her least to make things correct for them.Sophie reunites with her parents in the back of the courtyard, where everyone is back to themselves. Sophie continues to visit the castle, Markl and Howl everyday since their parents had to take a left turn near the fort to get to their home instead of going into the fort.');
story.set(12211, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.He goes to the spell trader, Abdullah. Abdullah is a wizard whose soccery runs on his business. He trades magic for power. Howl’s wizard powers are extremely powerful and rare as quoted by the queen herself. Abdullah readily agrees for the trade.Everything goes back to normal. The war which was about to happen was also stopped because of the spell Abdullah gave Howl. Howl and Sophie move in together peacefully after this incident. Sophie, who moved in as an 80 year old, becomes younger day by day spending time with Howl. Everyone is back to normal, except for the witch’s obsession over Howl. She still thinks Howl can belong to herself only. Witch arranges a meeting with the queen based on how Sophie can be a threat to Japan. They all meet in the courtroom, Howl, Witch and the queen. The queen notices the courtroom hall and remembers what actually happened. The queen was partly aware about the spell by then but did not disclose it out as it might harm Howl, her own disciple. Witch has the same thoughts as the queen, but instead will say it out loud. This causes Howl to transform in his original wizard form, the blue winged phoenix. His trade secret with Abdullah was simple: people will forget all of this happened, but if they remember in any case and conscience, you get transformed into your original form, but the ones who love you will be changed and transformed how they were before the time where Howl rescued Sophie from Shadows. Howl, creates all destruction before the castle, which was supposed to be a backup for Howl if something went wrong. It was Calcifer who kept the castle together and had been a trusted friend of Howl. All while Howl was creating ruckus, Calcifier had to become big enough to consume Howl, which would make Calcifer die. When Howl is in Calcifer, Sophie realizes there is a way all of this can be prevented. Howl shared the spell which was cast to him by Sophie,  so she knows the spell too. Sophie repeats the spell which Abdullah cast on Howl and casts it to the calcifer. This causes a loophole in the timeline, reverts everyone back to the birth of time. While all of this is happening, Howl says to Sophie her name and his name and asks her to remember his name.Pink lit sky, near the beach, Sophie in her 20s with Howl walks along the shore with a baby, whose name is Calcifer. Markl, Howl’s brother, helps an old woman cross the beach road and notices something is strange. The old woman begins to run towards Howl, but gets stopped by 2 skyline troops sent by the queen. With all this happening, none of Howl and Sophie were aware of anything.Years pass by and Sophie grows old. Howl, sits on his bench, reading his newspaper. Just then, he observes Sophie, who was narrating this story to her grandkids.');
story.set(12212, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.The queen helps Howl in the resurrection of the lives and removal of spells casted by the witch. The queen however has the motive to kill the witch of the waste, since she was being influenced by the witch.Howl and Sophie both on the other hand had another motive: Parents/ family of all the people who weren’t living in their human bodies. Howl for a reason had to do for some of the people since that was the direct order he had to follow. By listening to Howl’s perspective, the queen knew she had failed in fulfilling her duty as an empress. She did not put her people and their welfare in the first priority. So with an immediate action of removing the witch of the waste from her land, taking away her powers and causes of her powers, the queen did her least to make things correct for them.Sophie reunites with her parents in the back of the courtyard, where everyone is back to themselves. Sophie continues to visit the castle, Markl and Howl everyday since their parents had to take a left turn near the fort to get to their home instead of going into the fort.');
story.set(12221, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.He goes to the spell trader, Abdullah. Abdullah is a wizard whose soccery runs on his business. He trades magic for power. Howl’s wizard powers are extremely powerful and rare as quoted by the queen herself. Abdullah readily agrees for the trade.Everything goes back to normal. The war which was about to happen was also stopped because of the spell Abdullah gave Howl. Howl and Sophie move in together peacefully after this incident. Sophie, who moved in as an 80 year old, becomes younger day by day spending time with Howl. Everyone is back to normal, except for the witch’s obsession over Howl. She still thinks Howl can belong to herself only. Witch arranges a meeting with the queen based on how Sophie can be a threat to Japan. They all meet in the courtroom, Howl, Witch and the queen. The queen notices the courtroom hall and remembers what actually happened. The queen was partly aware about the spell by then but did not disclose it out as it might harm Howl, her own disciple. Witch has the same thoughts as the queen, but instead will say it out loud. This causes Howl to transform in his original wizard form, the blue winged phoenix. His trade secret with Abdullah was simple: people will forget all of this happened, but if they remember in any case and conscience, you get transformed into your original form, but the ones who love you will be changed and transformed how they were before the time where Howl rescued Sophie from Shadows. Howl, creates all destruction before the castle, which was supposed to be a backup for Howl if something went wrong. It was Calcifer who kept the castle together and had been a trusted friend of Howl. All while Howl was creating ruckus, Calcifier had to become big enough to consume Howl, which would make Calcifer die. When Howl is in Calcifer, Sophie realizes there is a way all of this can be prevented. Howl shared the spell which was cast to him by Sophie,  so she knows the spell too. Sophie repeats the spell which Abdullah cast on Howl and casts it to the calcifer. This causes a loophole in the timeline, reverts everyone back to the birth of time. While all of this is happening, Howl says to Sophie her name and his name and asks her to remember his name.Pink lit sky, near the beach, Sophie in her 20s with Howl walks along the shore with a baby, whose name is Calcifer. Markl, Howl’s brother, helps an old woman cross the beach road and notices something is strange. The old woman begins to run towards Howl, but gets stopped by 2 skyline troops sent by the queen. With all this happening, none of Howl and Sophie were aware of anything.Years pass by and Sophie grows old. Howl, sits on his bench, reading his newspaper. Just then, he observes Sophie, who was narrating this story to her grandkids.');
story.set(12222, 'She orders the assassination of Sophie with immediate effect. Howl resigns as a royal member of society without any consequences. Generally, if anyone resigns the royal wizard society there are certain consequences like lifetime fine or even Death penalty. But since it was a witch who was actually taking the decision, she doesn’t give Howl any consequences. This provocation starts an internal war between all wizards and Howl. Howl becomes protective and so does calcifer and Markl. The war breaks down, taking many lives. Howl, disheartenedly takes a chance of changing everything.The queen helps Howl in the resurrection of the lives and removal of spells casted by the witch. The queen however has the motive to kill the witch of the waste, since she was being influenced by the witch.Howl and Sophie both on the other hand had another motive: Parents/ family of all the people who weren’t living in their human bodies. Howl for a reason had to do for some of the people since that was the direct order he had to follow. By listening to Howl’s perspective, the queen knew she had failed in fulfilling her duty as an empress. She did not put her people and their welfare in the first priority. So with an immediate action of removing the witch of the waste from her land, taking away her powers and causes of her powers, the queen did her least to make things correct for them.Sophie reunites with her parents in the back of the courtyard, where everyone is back to themselves. Sophie continues to visit the castle, Markl and Howl everyday since their parents had to take a left turn near the fort to get to their home instead of going into the fort.');
// Create a new client instance
const client = new Client({ intents: [Intents.FLAGS.GUILDS] });

// When the client is ready, run this code (only once)
client.once('ready', () => {
	console.log('Ready!');
});

client.on('interactionCreate', async interaction => {
	if (!interaction.isCommand()) return;

	const { commandName, options } = interaction;
	if (commandName == 'start') {
		await interaction.deferReply({ ephemeral : true });
		let msg = '';
		let name = '';
		for (let i = 0; i < interaction.user.tag.length; i++) {
			if (interaction.user.tag[i] == '#') {
				continue;
			}
			name = name + interaction.user.tag[i];
		}
		try {
			const response = await axios.get('https://postgres-test2702.herokuapp.com/users/reset/' + name);
			const count = response.data[0].count;
			if (count == 0) {
				try {
					await axios.post('https://postgres-test2702.herokuapp.com/users', { name: name });
					msg = 'Game started for ' + name;
				}
				catch (err) {
					console.log(err);
					msg = 'Unable to start new game';
				}
			}
			else {
				try {
					await axios.put('https://postgres-test2702.herokuapp.com/users/reset/' + name);
					msg = 'Game restarted for ' + name + '\n' + story.get(1);
				}
				catch (err) {
					console.log(err);
					msg = 'Unable to restart game';
				}
			}
		}
		catch (err) {
			console.log(err);
			msg = 'Unable to start game';
		}
		// try {
		// 	await axios.post('https://postgres-test2702.herokuapp.com/users', { name: name });
		// 	msg = 'Game started for ' + name;
		// }
		// catch (err) {
		// 	msg = 'Restarting game';
		// 	try {
		// 		await axios.put('https://postgres-test2702.herokuapp.com/users/reset/' + name);
		// 	}
		// 	catch (err) {
		// 		msg = 'Unable to restart game';
		// 	}
		// }
		interaction.editReply({ content: msg, ephemeral: true });
	}
	else if (commandName == 'choose') {
		await interaction.deferReply({ ephemeral: true });
		const choice = options.getInteger('choice');
		if (choice != 1 && choice != 2) {
			await interaction.editReply({ content : 'Invalid choice please choose again.', ephemeral : true });
			return;
		}
		let msg = '';
		let name = '';
		for (let i = 0; i < interaction.user.tag.length; i++) {
			if (interaction.user.tag[i] == '#') {
				continue;
			}
			name = name + interaction.user.tag[i];
		}
		// console.log('Works here');
		try {
			await axios.put('https://postgres-test2702.herokuapp.com/users/' + name, { choice: choice });
			const resp = await axios.get('https://postgres-test2702.herokuapp.com/users/' + name);
			const level = resp.data[0].level;
			const levelText = level.toString();
			if (levelText.length > 5) {
				await interaction.editReply({ content : 'Game already over. Restart the game to play an alternate version', ephemeral : true });
				return;
			}
			msg = story.get(parseInt(level));
		}
		catch (err) {
			console.log(err);
			msg = 'Unable to update user level';
		}
		await interaction.editReply({ content : msg, ephemeral: true });
	}
	else if (commandName == 'prompt') {
		await interaction.deferReply({ ephemeral: true });
		let msg = '';
		let name = '';
		for (let i = 0; i < interaction.user.tag.length; i++) {
			if (interaction.user.tag[i] == '#') {
				continue;
			}
			name = name + interaction.user.tag[i];
		}
		try {
			const resp = await axios.get('https://postgres-test2702.herokuapp.com/users/' + name);
			const level = resp.data[0].level;
			if (level.toString().length > 5) {
				msg = 'Game over. Restart game to play an alternative version.';
			}
			else {
				msg = story.get(parseInt(level));
			}
		}
		catch (err) {
			console.log(err);
			msg = 'Unable to retrieve users';
		}
		await interaction.editReply({ content : msg, ephemeral: true });
	}
});

// Login to Discord with your client's token
client.login(process.env.TOKEN);